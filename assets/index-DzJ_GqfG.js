import{r as s}from"./index-B1GeB8Nz.js";import{u as g}from"./index-BAi9YrL4.js";var A=globalThis!=null&&globalThis.document?s.useLayoutEffect:()=>{};function P(n,e){return s.useReducer((r,t)=>e[r][t]??r,n)}var R=n=>{const{present:e,children:r}=n,t=h(e),o=typeof r=="function"?r({present:t.isPresent}):s.Children.only(r),c=g(t.ref,w(o));return typeof r=="function"||t.isPresent?s.cloneElement(o,{ref:c}):null};R.displayName="Presence";function h(n){const[e,r]=s.useState(),t=s.useRef({}),o=s.useRef(n),c=s.useRef("none"),p=n?"mounted":"unmounted",[l,u]=P(p,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return s.useEffect(()=>{const i=N(t.current);c.current=l==="mounted"?i:"none"},[l]),A(()=>{const i=t.current,m=o.current;if(m!==n){const d=c.current,a=N(i);n?u("MOUNT"):a==="none"||(i==null?void 0:i.display)==="none"?u("UNMOUNT"):u(m&&d!==a?"ANIMATION_OUT":"UNMOUNT"),o.current=n}},[n,u]),A(()=>{if(e){let i;const m=e.ownerDocument.defaultView??window,f=a=>{const O=N(t.current).includes(a.animationName);if(a.target===e&&O&&(u("ANIMATION_END"),!o.current)){const T=e.style.animationFillMode;e.style.animationFillMode="forwards",i=m.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=T)})}},d=a=>{a.target===e&&(c.current=N(t.current))};return e.addEventListener("animationstart",d),e.addEventListener("animationcancel",f),e.addEventListener("animationend",f),()=>{m.clearTimeout(i),e.removeEventListener("animationstart",d),e.removeEventListener("animationcancel",f),e.removeEventListener("animationend",f)}}else u("ANIMATION_END")},[e,u]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:s.useCallback(i=>{i&&(t.current=getComputedStyle(i)),r(i)},[])}}function N(n){return(n==null?void 0:n.animationName)||"none"}function w(n){var t,o;let e=(t=Object.getOwnPropertyDescriptor(n.props,"ref"))==null?void 0:t.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?n.ref:(e=(o=Object.getOwnPropertyDescriptor(n,"ref"))==null?void 0:o.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?n.props.ref:n.props.ref||n.ref)}function I(n){const e=s.useRef(n);return s.useEffect(()=>{e.current=n}),s.useMemo(()=>(...r)=>{var t;return(t=e.current)==null?void 0:t.call(e,...r)},[])}function U(n,e,{checkForDefaultPrevented:r=!0}={}){return function(o){if(n==null||n(o),r===!1||!o.defaultPrevented)return e==null?void 0:e(o)}}export{R as P,A as a,U as c,I as u};
